Бидуга  Рис. 1. Примеры бидуг Бидуга́ (англ. biarc, biarc  curve) — гладкая плоская кривая, составленная из двух круговых дуг, меньших полной окружности. Одной из дуг может быть отрезок прямой. Бидуги были предложены [1] для геометрического моделирования (построения, аппроксимации) кривых с заданными граничными точками и касательными в них. В классе бидуг эта задача имеет целое семейство решений, и требует дополнительных условий для нахождения конкретных кривых. Таковыми могут быть задание кривизны или поворота одной из дуг, фиксированная длина кривой[2], требование минимизации скачка кривизны в точке сопряжения, и т.п. У бидуги зависимость     k ( s )   {\displaystyle k(s)}   кривизны от длины дуги монотонна (так как состоит из двух постоянных участков), поэтому бидуга является простейшей спиралью[3].  Содержание  1 Примеры бидуг 2 Описание семейства бидуг  2.1 Соотношения для углов и кривизн 2.2 Геометрическое место точек сопряжения 2.3 Вырожденные бидуги 2.4 Структура семейства   3 Ссылки 4 Литература 5 См. также   Примеры бидуг[править | править код] На рис. 1 показаны шесть бидуг     A J B   {\displaystyle AJB}  . Точки     A   {\displaystyle A}   и     B   {\displaystyle B}   – начальная и конечная точки кривой,     J   {\displaystyle J}   (join) – точка гладкого сопряжения двух дуг. Примеры 1–4 иллюстрируют короткие бидуги: они не пересекают дополнение хорды до бесконечной прямой, хотя могут пересекать саму хорду (бидуга 1). Обычно именно такие кривые являются объектами аппроксимации. Примеры 5 и 6 иллюстрируют длинные бидуги: они пересекают дополнение хорды, т.е. закручиваются вокруг одной из концевых точек.  Кривые помещены в систему координат хорды, в которой координаты начальной и конечной точек равны     A = ( − c , 0 )   {\displaystyle A=(-c,0)}   и     B = ( c , 0 )   {\displaystyle B=(c,0)}  , где     2 c =  |  A B  |    {\displaystyle 2c=|AB|}   – длина хорды. Ориентированные углы наклонов касательных в точках     A   {\displaystyle A}   и     B   {\displaystyle B}  , измеренные относительно направления хорды        A B  →     {\displaystyle {\overrightarrow {AB}}}  , обозначены     α   {\displaystyle \alpha }   и     β   {\displaystyle \beta }  . Так, у бидуги 1 на рис. 1      α > 0 ,  β > 0   {\displaystyle \alpha >0,\;\beta >0}  , а у бидуг 2-6     α > 0 ,  β < 0   {\displaystyle \alpha >0,\;\beta <0}  .  Описание семейства бидуг[править | править код] Граничные касательные векторы у кривых 2–6 на рис. 1 одинаковы:     α =  100  ∘   ,  β = −  30  ∘   .   {\displaystyle \alpha =100^{\circ },\quad \beta =-30^{\circ }.}   Эти кривые являются членами однопараметрического семейства бидуг с общими касательными на концах. Всё семейство показано на нижнем фрагменте рисунка 2. Далее основные свойства семейства бидуг с общими касательными на концах приведены по материалам статьи[4]. Параметр семейства обозначен      p   {\displaystyle p}  . Обозначение бидуги в виде       B   ( p )   {\displaystyle {\mathcal {B}}(p)}   подразумевает фиксацию констант, т.е.       B   ( p ;  α , β , c )   {\displaystyle {\mathcal {B}}(p;\,\alpha ,\beta ,c)}  . Рисунки 2, 3, 4 иллюстрируют такие семейства для различных пар     { α , β } .   {\displaystyle \{\alpha ,\beta \}.}       Рис. 2. Семейства бидуг с общими касательными на концах (два примера)   Рис. 3. Два семейства с общими (параллельными) касательными на концах:     α = β   {\displaystyle \alpha =\beta }     Рис. 4. Семейства бидуг с      |  α  |  = π   {\displaystyle |\alpha |=\pi }   или       |  β  |  = π   {\displaystyle |\beta |=\pi }     Соотношения для углов и кривизн[править | править код] Углы     α   {\displaystyle \alpha }   и     β   {\displaystyle \beta }   считаются определёнными в диапазоне     [ − π ;  π ]   {\displaystyle [-\pi ;\,\pi ]}  :     − π ⩽ α ⩽ π   {\displaystyle -\pi \leqslant \alpha \leqslant \pi }  ,      − π ⩽ β ⩽ π   {\displaystyle -\pi \leqslant \beta \leqslant \pi }  . Построение бидуги возможно при       0 <  |  α + β  |  < 2 π .  ( 1 )   {\displaystyle \qquad 0<|\alpha +\beta |<2\pi .\qquad (1)}   Введём обозначения       ω =    α + β  2   ,  γ =    α − β  2     {\displaystyle \omega ={\frac {\alpha +\beta }{2}},\quad \gamma ={\frac {\alpha -\beta }{2}}}  . Неравенства (1) означают, что     sin ⁡ ω ≠ 0   {\displaystyle \sin \omega \not =0}  . Кривизна      k  1     {\displaystyle k_{1}}   первой дуги     ( A J )   {\displaystyle (AJ)}   и  кривизна      k  2     {\displaystyle k_{2}}   второй дуги     ( J B )   {\displaystyle (JB)}   выражаются, как функции параметра семейства, следующими формулами:       k  1   ( p ) =   1 c    (  − sin ⁡ α −    sin ⁡ ω  p    )  ,   k  2   ( p ) =   1 c    (  sin ⁡ β + p sin ⁡ ω  )  .   {\displaystyle k_{1}(p)={\frac {1}{c}}\left(-\sin \alpha -{\frac {\sin \omega }{p}}\right),\quad k_{2}(p)={\frac {1}{c}}\left(\sin \beta +p\sin \omega \right).}   Пусть       θ  1     {\displaystyle \theta _{1}}   и      L  1     {\displaystyle L_{1}}   – поворот и длина дуги     A J   {\displaystyle AJ}  :         θ  1   =  k  1    L  1     {\displaystyle \theta _{1}=k_{1}L_{1}}  ;      θ  2     {\displaystyle \theta _{2}}   и      L  2     {\displaystyle L_{2}}   – поворот и длина дуги     J B   {\displaystyle JB}  :         θ  2   =  k  2    L  2     {\displaystyle \theta _{2}=k_{2}L_{2}}  . Справедливы равенства       θ  1   ( p ) = 2 arg ⁡  (    e   −  i  α   +  p  − 1      e   −  i  ω     )  ,   θ  2   ( p ) = 2 arg ⁡  (    e    i  β   + p    e    i  ω    )  .   {\displaystyle \theta _{1}(p)=2\arg \left(\mathrm {e} ^{-\mathrm {i} \alpha }+p^{-1}{\mathrm {e} ^{-\mathrm {i} \omega }}\right),\quad \theta _{2}(p)=2\arg \left(\mathrm {e} ^{\mathrm {i} \beta }+p\,\mathrm {e} ^{\mathrm {i} \omega }\right).}   Геометрическое место точек сопряжения[править | править код] Точки сопряжения     J   {\displaystyle J}    двух дуг расположены на окружности       X  J   ( p ) =    c (  p  2   − 1 )    p  2   + 2 p cos ⁡ γ + 1    ,   Y  J   ( p ) =    2 c p sin ⁡ γ    p  2   + 2 p cos ⁡ γ + 1    ,  − ∞ ⩽ p ⩽ ∞ .  ( 2 )   {\displaystyle X_{J}(p)={\frac {c(p^{2}-1)}{p^{2}+2p\cos \gamma +1}},\quad Y_{J}(p)={\frac {2cp\sin \gamma }{p^{2}+2p\cos \gamma +1}},\quad -\infty \leqslant p\leqslant \infty .\qquad (2)}   Эта окружность выходит из точки     A   {\displaystyle A}   под углом     γ   {\displaystyle \gamma }   и проходит через точку     B   {\displaystyle B}  . При     γ = 0   {\displaystyle \gamma =0}   (т.е. при     α = β   {\displaystyle \alpha =\beta }  ) это прямая      A B   {\displaystyle AB}   (рис. 3). Бидуги семейства пересекают эту окружность под постоянным углом      ω   {\displaystyle \omega }  . Вектор касательной к бидуге в точке сопряжения есть      |   |  cos ⁡  τ      J     ,  sin ⁡  τ      J      |   |    {\displaystyle ||\cos \tau _{{}_{J}},\,\sin \tau _{{}_{J}}||}  , где       τ      J     ( p ) =  − 2  arctg ⁡     p sin ⁡   α 2   + sin ⁡   β 2     p cos ⁡   α 2   + cos ⁡   β 2       .   {\displaystyle \tau _{{}_{J}}(p)={-2}\operatorname {arctg} {\dfrac {p\sin {\frac {\alpha }{2}}+\sin {\frac {\beta }{2}}}{p\cos {\frac {\alpha }{2}}+\cos {\frac {\beta }{2}}}}.}   Бидуга с минимальным скачком кривизны в точке сопряжения,     min  |   k  2   ( p ) −  k  1   ( p )  |  ,   {\displaystyle \min \left|k_{2}(p)-k_{1}(p)\right|,}   реализуется при     p = ± 1 ;   {\displaystyle p=\pm 1;}   точка     J   {\displaystyle J}   при этом лежит на оси ординат     (  X  J   = 0 ) .   {\displaystyle (X_{J}=0).}    Вырожденные бидуги[править | править код] В семействе бидуг можно выделить следующие вырожденные бидуги.    Бидуга       B   ( 0 )   {\displaystyle {\mathcal {B}}(0)}  : при     p → 0   {\displaystyle p\to 0}   точка сопряжения     J ( p )   {\displaystyle J(p)}   бидуги     A J B   {\displaystyle AJB}   стремится к точке     A   {\displaystyle A}  , часть     A J   {\displaystyle AJ}   исчезает, превращаясь в бесконечный импульс кривизны. Бидуга вырождается в дугу окружности, опирающуюся на хорду     A B   {\displaystyle AB}   и имеющую с бидугами семейства общую касательную в конечной точке.  Бидуга       B   ( ∞ )   {\displaystyle {\mathcal {B}}(\infty )}  : стремление     p → ∞   {\displaystyle p\to \infty }   влечёт     J ( p ) → B   {\displaystyle J(p)\to B}  , часть     J B   {\displaystyle JB}   исчезает. Бидуга вырождается в дугу окружности, опирающуюся на хорду     A B   {\displaystyle AB}   и имеющую с бидугами семейства общую касательную в начальной точке.  Бидуга       B   (  p  ∗   )   {\displaystyle {\mathcal {B}}(p^{\ast })}  , где       p  ∗   =  {     −     sin ⁡ ω   sin ⁡ α     ,     если    |  α  |  ⩾  |  β  |   ( − ∞ ,   если    |  α  |  = π ) ,     −     sin ⁡ β   sin ⁡ ω     ,     если    |  α  |  ⩽  |  β  |   (  0 ,     если    |  β  |  = π ) ,         {\displaystyle \qquad p^{\ast }=\left\{{\begin{array}{lll}-{\dfrac {\sin \omega }{\sin \alpha }},\quad &{\text{если}}\;|\alpha |\geqslant |\beta |\quad (-\infty ,\;{\text{если}}\;|\alpha |=\pi ),\\-{\dfrac {\sin \beta }{\sin \omega }},\quad &{\text{если}}\;|\alpha |\leqslant |\beta |\quad (\;0,\;\;\;{\text{если}}\;|\beta |=\pi ),\end{array}}\right.}   представляет собой разрывную бидугу, проходящую через бесконечно удалённую точку плоскости. Всегда      p  ∗   ⩽ 0   {\displaystyle p^{\ast }\leqslant 0}  , а неравенства (1) исключают одновременное равенство      |  α  |  =  |  β  |  = π   {\displaystyle |\alpha |=|\beta |=\pi }  .  На рисунках 2, 3 разрывные бидуги показаны красной штрих-пунктирной линией.  С учётом этих трёх вырожденных бидуг через любую точку плоскости с выколотыми полюсами     A   {\displaystyle A}   и     B   {\displaystyle B}   проходит единственная бидуга       B   ( p )   {\displaystyle {\mathcal {B}}(p)}  .  Структура семейства[править | править код] В семействе бидуг       B   ( p ;  α , β , c )   {\displaystyle {\mathcal {B}}(p;\,\alpha ,\beta ,c)}   выделим, в зависимости от значения параметра     p ,   {\displaystyle p,}  , следующие подсемейства невырожденных бидуг:             B     +   ( p )  :   p ∈ ( 0 ; ∞ ) ;        B    1    −   ( p )  :   p ∈ (  p  ∗   ; 0 ) ;        B    2    −   ( p )  :   p ∈ ( − ∞ ;  p  ∗   ) ;        B     −   ( p ) =    B    1    −   ( p ) ∪    B    2    −   ( p )       {\displaystyle {\begin{array}{l}{\mathcal {B}}^{\,+}(p){:}\quad p\in (0;\infty );\\{\mathcal {B}}_{1}^{\,-}(p){:}\quad p\in (p^{\ast };0);\\{\mathcal {B}}_{2}^{\,-}(p){:}\quad p\in (-\infty ;p^{\ast });\\{\mathcal {B}}^{\,-}(p)={\mathcal {B}}_{1}^{\,-}(p)\cup {\mathcal {B}}_{2}^{\,-}(p)\end{array}}}   (в[4], Property 2, подсемейства        B     +     {\displaystyle {\mathcal {B}}^{\,+}}   и        B     −     {\displaystyle {\mathcal {B}}^{\,-}}   названы, соответственно, main subfamily и complementary subfamily). На рисунках 2, 3, 4 бидуги, принадлежащие подсемействам         B     +      {\displaystyle \color {sienna}{\mathcal {B}}^{\,+}}  ,         B    1    −      {\displaystyle \color {blue}{\mathcal {B}}_{1}^{\,-}}   и         B    2    −      {\displaystyle \color {green}{\mathcal {B}}_{2}^{\,-}}   показаны, соответственно, коричневым, синим и  зелёным цветом.  Бидуги подсемейства        B     +     {\displaystyle {\mathcal {B}}^{\,+}}   – короткие. Их кривизна либо возрастает (если     ω > 0   {\displaystyle \omega >0}  ), либо убывает (если     ω < 0   {\displaystyle \omega <0}  ):     sgn ⁡ (  k  2   −  k  1   ) = sgn ⁡ ω = sgn ⁡ ( α + β )   {\displaystyle \operatorname {sgn}(k_{2}-k_{1})=\operatorname {sgn} \omega =\operatorname {sgn}(\alpha +\beta )}   (теорема В.Фогта для коротких спиралей). Они заключены внутри линзы – области, ограниченной вырожденными бидугами       B   ( 0 )   {\displaystyle {\mathcal {B}}(0)}   и       B   ( ∞ )   {\displaystyle {\mathcal {B}}(\infty )}   (на рисунках область линзы затемнена). Угловая ширина линзы (со знаком) равна     α + β = 2 ω   {\displaystyle \alpha +\beta =2\omega }  . ГМТ (2) есть биссектриса линзы.  Бидуги подсемейства        B     −     {\displaystyle {\mathcal {B}}^{\,-}}   имеют противоположный (по отношению к        B     +     {\displaystyle {\mathcal {B}}^{\,+}}  ) характер монотонности кривизны:     sgn ⁡ (  k  2   −  k  1   ) = − sgn ⁡ ω .   {\displaystyle \operatorname {sgn} (k_{2}-k_{1})=-\operatorname {sgn} \omega .}   Подсемейство        B    1    −     {\displaystyle {\mathcal {B}}_{1}^{\,-}}   пусто, если      p  ∗   = 0   {\displaystyle p^{\ast }=0}           (  |  β  |  = π ) .   {\displaystyle (|\beta |=\pi ).}   Подсемейство        B    2    −     {\displaystyle {\mathcal {B}}_{2}^{\,-}}   пусто, если      p  ∗   = − ∞   {\displaystyle p^{\ast }=-\infty }       (  |  α  |  = π ) .   {\displaystyle (|\alpha |=\pi ).}   Если      |  α  |  ≠ π   {\displaystyle |\alpha |\not =\pi }   и      |  β  |  ≠ π   {\displaystyle |\beta |\not =\pi }  , то бидуги этого подсемейства – длинные. Разрывная бидуга        B   (  p  ∗   )    {\displaystyle \color {red}{\mathcal {B}}(p^{\ast })}   отграничивает друг от друга бидуги подсемейств        B      1   ,   2      −     {\displaystyle {\mathcal {B}}_{{\color {blue}1},{\color {green}2}}^{\,-}}  .  Переопределение граничных углов в кумулятивном смысле. Интегрирование натурального уравнения бидуги даёт непрерывную (кусочно-линейную) функцию     τ ( s )   {\displaystyle \tau (s)}   – угол наклона касательной к кривой. При таком определении, непрерывном, её значения могут выйти за пределы     ± π   {\displaystyle \pm \pi }  , и значения на концах могут отличаться от     α , β   {\displaystyle \alpha ,\beta }   на     ± 2 π .   {\displaystyle \pm 2\pi .}   Определим, наряду с     α , β   {\displaystyle \alpha ,\beta }  , кумулятивные версии граничных углов в виде        α ~    ,    β ~      {\displaystyle {\widetilde {\alpha }},{\widetilde {\beta }}}  , с учётом непрерывности     τ ( s ) .   {\displaystyle \tau (s).}   Поправка к углу     α   {\displaystyle \alpha }   вносится, если бидуга совершает оборот вокруг точки     A ,   {\displaystyle A,}   т.е. пересекает луч     { x < − c ,  y = 0 }   {\displaystyle \{x<-c,\,y=0\}}  ; поправка к углу     β   {\displaystyle \beta }   вносится, если бидуга совершает оборот вокруг точки     B   {\displaystyle B}   (пересекая правое дополнение хорды до бесконечной прямой):  в подсемействе        B     +     {\displaystyle {\mathcal {B}}^{\,+}}  :           α ~    = α ,       β ~    = β   {\displaystyle {\widetilde {\alpha }}=\alpha ,\qquad \qquad \quad {\widetilde {\beta }}=\beta }  ; в подсемействе        B    1    −     {\displaystyle {\mathcal {B}}_{1}^{\,-}}  :           α ~    = α − 2 π sgn ⁡ ω ,     β ~    = β   {\displaystyle {\widetilde {\alpha }}=\alpha -2\pi \operatorname {sgn} \omega ,\;{\widetilde {\beta }}=\beta }  ; в подсемействе        B    2    −     {\displaystyle {\mathcal {B}}_{2}^{\,-}}  :           α ~    = α ,       β ~    = β − 2 π sgn ⁡ ω   {\displaystyle {\widetilde {\alpha }}=\alpha ,\qquad \qquad \quad {\widetilde {\beta }}=\beta -2\pi \operatorname {sgn} \omega }  . Тогда полный поворот бидуги        B   ( p )   {\displaystyle {\mathcal {B}}(p)}    равен       θ  1   ( p ) +  θ  2   ( p ) =    β ~    −    α ~    ,   {\displaystyle \theta _{1}(p)+\theta _{2}(p)={\widetilde {\beta }}-{\widetilde {\alpha }},}   а возрастание/убывание кривизны соответствует равенству      sgn ⁡ (  k  2   −  k  1   ) = sgn ⁡ (    α ~    +    β ~    )   {\displaystyle \operatorname {sgn}(k_{2}-k_{1})=\operatorname {sgn}({\widetilde {\alpha }}+{\widetilde {\beta }})}   (обобщение теоремы В.Фогта). Так, для бидуг с возрастающей кривизной      k  2   >  k  1     {\displaystyle k_{2}>k_{1}}   имеем         α ~    > − π ,     β ~    > − π ,  0 <    α ~    +    β ~    < 2 π .   {\displaystyle {\widetilde {\alpha }}>-\pi ,\quad {\widetilde {\beta }}>-\pi ,\quad 0<{\widetilde {\alpha }}+{\widetilde {\beta }}<2\pi .}     Ссылки[править | править код]   ↑  Bolton, K. M. (1975). “Biarc curves”. Computer-Aided Design. 7 (2): 89—92. DOI:10.1016/0010-4485(75)90086-X. Внешняя ссылка в |journal= (справка на английском).mw-parser-output cite.citation{font-style:inherit}.mw-parser-output q{quotes:"\"""\"""'""'"}.mw-parser-output code.cs1-code{color:inherit;background:inherit;border:inherit;padding:inherit}.mw-parser-output .cs1-lock-free a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/9px-Lock-green.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .cs1-lock-limited a,.mw-parser-output .cs1-lock-registration a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/d/d6/Lock-gray-alt-2.svg/9px-Lock-gray-alt-2.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .cs1-lock-subscription a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/a/aa/Lock-red-alt-2.svg/9px-Lock-red-alt-2.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .cs1-subscription,.mw-parser-output .cs1-registration{color:#555}.mw-parser-output .cs1-subscription span,.mw-parser-output .cs1-registration span{border-bottom:1px dotted;cursor:help}.mw-parser-output .cs1-hidden-error{display:none;font-size:100%}.mw-parser-output .cs1-visible-error{font-size:100%}.mw-parser-output .cs1-subscription,.mw-parser-output .cs1-registration,.mw-parser-output .cs1-format{font-size:95%}.mw-parser-output .cs1-kern-left,.mw-parser-output .cs1-kern-wl-left{padding-left:0.2em}.mw-parser-output .cs1-kern-right,.mw-parser-output .cs1-kern-wl-right{padding-right:0.2em}  ↑  Сабитов И.Х., Словеснов А.В. Приближение плоских кривых круговыми дугами // Журнал вычислительной математики и математической физики. — 2010. — Т. 50, № 8. — С. 1347–1356.  ↑  Курносенко А.И. Общие свойства плоских спиральных кривых // Записки научных семинаров ПОМИ. — 2009. — Т. 353. — С. 93-115. — ISSN 0373-2703. [1]  ↑ 1 2  Kurnosenko, A. I. (2013). “Biarcs and bilens”. Computer Aided Geometric Design. 30 (3): 310—330. DOI:10.1016/j.cagd.2012.12.002. Внешняя ссылка в |journal= (справка на английском) [2]   Литература[править | править код] Nutbourne, A. W. Differential geometry applied to curve and surface design. Vol.1: Foundations. / A. W. Nutbourne, Martin. — Ellis Horwood, 1988. — ISBN 013211822X. См. также[править | править код] Теорема Фогта    