Метод обратного преобразования Ме́тод обра́тного преобразова́ния (Преобразование Н. В. Смирнова) — способ генерации случайных величин с заданной функцией распределения, путём модификации работы генератора равномерно распределённых чисел.  Содержание  1 Описание алгоритма  1.1 Строго возрастающая функция распределения  1.1.1 Пример   1.2 Неубывающая функция распределения   2 Замечания 3 Математическое обоснование 4 См. также 5 Литература   Описание алгоритма[править | править код] Пусть     F ( x )   {\displaystyle F(x)}   является функцией произвольного распределения. Покажем как, имея генератор выборки из стандартного непрерывного равномерного распределения, получить выборку из распределения, задаваемого функцией распределения     F ( x )   {\displaystyle F(x)}  .  Строго возрастающая функция распределения[править | править код] Если функция     F :  R  → [ 0 , 1 ]   {\displaystyle F:\mathbb {R} \to [0,1]}   строго возрастает на всей области определения, то она биективна, а следовательно имеет обратную функцию      F  − 1   : [ 0 , 1 ] →  R    {\displaystyle F^{-1}:[0,1]\to \mathbb {R} }  .  Пусть      U  1   , … ,  U  n   ∼ U [ 0 , 1 ]   {\displaystyle U_{1},\ldots ,U_{n}\sim U[0,1]}   — выборка из стандартного непрерывного равномерного распределения. Тогда      X  1   , … ,  X  n     {\displaystyle X_{1},\ldots ,X_{n}}  , где      X  i   =  F  − 1   (  U  i   ) ,  i = 1 , … , n   {\displaystyle X_{i}=F^{-1}(U_{i}),\;i=1,\ldots ,n}  , — выборка из интересующего нас распределения. Пример[править | править код] Пусть требуется сгенерировать выборку из экспоненциального распределения с параметром     λ > 0   {\displaystyle \lambda >0}  . Функция этого распределения     F ( x ) = 1 −  e  − λ x     {\displaystyle F(x)=1-e^{-\lambda x}}   строго возрастает, и её обратная функция имеет вид      F  − 1   ( x ) = −   1 λ    ln ⁡ ( 1 − x )   {\displaystyle F^{-1}(x)=-{\frac {1}{\lambda }}\,\ln(1-x)}  . Таким образом, если      U  1   , … ,  U  n     {\displaystyle U_{1},\ldots ,U_{n}}   — выборка из стандартного непрерывного равномерного распределения, то      X  1   , … ,  X  n     {\displaystyle X_{1},\ldots ,X_{n}}  , где       X  i   = −   1 λ   ln ⁡ ( 1 −  U  i   ) ,  i = 1 , … , n   {\displaystyle X_{i}=-{\frac {1}{\lambda }}\ln(1-U_{i}),\;i=1,\ldots ,n}   — искомая выборка из экспоненциального распределения.  Неубывающая функция распределения[править | править код] Если функция     F :  R  → [ 0 , 1 ]   {\displaystyle F:\mathbb {R} \to [0,1]}   лишь не убывает, то её обратная функция может не существовать. В таком случае необходимо модифицировать приведённый выше алгоритм.  Пусть      U  1   , … ,  U  n   ∼ U [ 0 , 1 ]   {\displaystyle U_{1},\ldots ,U_{n}\sim U[0,1]}   — выборка из стандартного непрерывного равномерного распределения. Тогда      X  1   , … ,  X  n     {\displaystyle X_{1},\ldots ,X_{n}}  , где      X  i   = inf { x ∣ F ( x ) =  U  i   } = min { x ∣ F ( x ) =  U  i   } ,  i = 1 , … , n   {\displaystyle X_{i}=\inf\{x\mid F(x)=U_{i}\}=\min\{x\mid F(x)=U_{i}\},\;i=1,\ldots ,n}  , — выборка из интересующего нас распределения. Равенство точной нижней грани минимуму выполняется ввиду непрерывности функции распределения справа, что означает, что точная нижняя грань достигается. Замечания[править | править код] Если     F ( x )   {\displaystyle F(x)}   строго возрастает, то      F  − 1   ( u ) = inf { x ∣ F ( x ) = u }   {\displaystyle F^{-1}(u)=\inf\{x\mid F(x)=u\}}  . Таким образом, модифицированный алгоритм для произвольной функции распределения включает в себя отдельно разобранный случай строго возрастающей функции распределения. Несмотря на кажущуюся универсальность, данный алгоритм имеет серьёзные практические ограничения. Даже если функция распределения строго возрастает, вычислить её обратную не всегда просто, особенно если она не задана в виде элементарной функции, как, например, в случае нормального распределения. В случае функции распределения общего вида чаще всего необходимо численно находить точную нижнюю грань, что может быть очень трудоёмко. Математическое обоснование[править | править код] Пусть     U ∼ U [ 0 , 1 ]   {\displaystyle U\sim U[0,1]}  , то есть      F  U   ( u ) = u ,  u ∈ [ 0 , 1 ]   {\displaystyle F_{U}(u)=u,\;u\in [0,1]}  . Рассмотрим функцию распределения случайной величины     X = inf { x ∣ F ( x ) = U }   {\displaystyle X=\inf\{x\mid F(x)=U\}}  .       P  ( X ≤ x ) =  P  ( inf {  x ′  ∣ F (  x ′  ) = U } ≤ x ) =  P  ( U ≤ F ( x ) ) =  F  U   ( F ( x ) ) = F ( x )   {\displaystyle \mathbb {P} (X\leq x)=\mathbb {P} (\inf\{x'\mid F(x')=U\}\leq x)=\mathbb {P} (U\leq F(x))=F_{U}(F(x))=F(x)}  . То есть     X   {\displaystyle X}   имеет функцию распределения     F ( x )   {\displaystyle F(x)}  .  См. также[править | править код] Преобразование Бокса — Мюллера Алгоритм Зиккурат Литература[править | править код] Вадзинский Р.Н. Справочник по вероятностным распределениям. - СПб.: Наука, 2001, 295 с.     